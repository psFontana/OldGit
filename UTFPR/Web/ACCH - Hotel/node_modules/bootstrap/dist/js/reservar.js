document.getElementById("reserva").addEventListener("submit", (event) => {
  event.preventDefault();

  const nome = document.getElementById("nome").value.trim();
  const telefone = document.getElementById("telefone").value.trim();
  const email = document.getElementById("email").value.trim();
  const comprovante = document.getElementById("comprovante").files[0];

  if (!nome || !telefone || !email || !comprovante) {
    alert("Por favor, preencha todos os campos obrigatórios.");
    return;
  }

  const telefoneRegex = /^\(\d{2}\) \d{5}-\d{4}$/;
  if (!telefoneRegex.test(telefone)) {
    alert("Por favor, insira um telefone válido no formato (XX) XXXXX-XXXX.");
    return;
  }

  const existingData = JSON.parse(localStorage.getItem("formData")) || [];
  const id = existingData.length + 1; // Gera o ID baseado na quantidade de dados salvos

  const formData = {
    id,
    nome,
    telefone,
    email,
    comprovanteNome: comprovante.name,
  };

  existingData.push(formData);
  localStorage.setItem("formData", JSON.stringify(existingData));

  const feedback = document.getElementById("feedback");
  feedback.className = "alert alert-success mt-3";
  feedback.innerText = "Formulário enviado com sucesso!";

  document.querySelector("form").reset();
});

document.getElementById("telefone").addEventListener("input", (event) => {
  let telefone = event.target.value.replace(/\D/g, ""); 

  if (telefone.length > 11) telefone = telefone.slice(0, 11); 

  if (telefone.length >= 6) {
    telefone = `(${telefone.slice(0, 2)}) ${telefone.slice(2, 7)}-${telefone.slice(7)}`;
  } else if (telefone.length >= 3) {
    telefone = `(${telefone.slice(0, 2)}) ${telefone.slice(2)}`;
  } else if (telefone.length > 0) {
    telefone = `(${telefone}`;
  }

  event.target.value = telefone;
});
